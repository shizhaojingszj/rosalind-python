from .lib.fasta_reader import Fasta


test0 = """>Rosalind_6404
CCTGCGGAAGATCGGCACTAGAATAGCCAGAACCGTTTCTCTGAGGCTTCCGGCCTTCCC
TCCCACTAATAATTCTGAGG
>Rosalind_5959
CCATCGGTAGCGCATCCTTAGTCCAATTAAGTCCCTATCCAGGCGCTCCGCCGAAGGTCT
ATATCCATTTGTCAGCAGACACGC
>Rosalind_0808
CCACCCTCGTGGTATGGCTAGGCATTCAGGAACCGGAGAACGCTTCAGACCAGCCCGGAC
TGGGAACCTGCGGGCAGTAGGTGGAAT"""

ans0 = """Rosalind_0808
60.919540"""


test1= """\
>Rosalind_0511
TGCGGAGTCTATTCCTTCTGCGTATGCGGCTGCCAAGGAAGGCCAATGATTACGCCCCGT
CTGGATGCCTATGATTGTGAGTAGGCTCGTGGAGCTTAAGCACCGTTATTCTGGCCATGT
GTGTACAAAACCTTGACCACATCCCTATGGACCCGGCCATGAGATTACTCTATCTAATCG
AGATATATAAGGCGCGCGCAAAGATATGTACCGTCTCAGCAGCAAATATTTATTTCGTAA
CTGTGCACGCACACGAATTACCGTATCAGCGTCCCAATTTTTTAACGATCACACCAAACG
TGACGGCTAAATAAGACCGGCTTTTCTCTGTCGGTTACGGCAAGCGATGAGCAGTTCGTC
CTAAAGAAAGCTTACGACATGAACGCCGGTATCTTGAAGGCGACGTAAAGACAGTCCGAA
CGCGTTACGCTGTTCTGAGCAGTGATGATCTCACACATAAGCAAGACTAGTAACCTTCTG
TGTCGTCCCAGACCACAAGAGTATGCCATCTAAGTGGTCTACGCGCGTTGATGCCGTAAA
GTGTGCAGCACATACCTGGGCGAGTGGAGGCAGCAATGATGGGTCCTATCAGCTTAGGGC
CTATGGCAATACGCTTTTTTTCTAGGTTAGCCGGTGCACTAGGCGTAACCTTTAGCGTGT
GGGGGAGAGGTAGTGCCCCTAATCGTCTACCTTTCTACGATCGAAAATATCTCCCTGGGG
CTAGGGGGAAATCTAACGAGATTAGCAGCGGTATCCGAATCCTTTCTTCTAAACCCCTGA
CTATCGGGCATGGACCCCACTTTATAGGCCATTTGACGAGCACTTACCAAAGTAAAGCTG
AGACAGCACTTTGCCACAGTTATGAATGACAAACGTCCCAGTTCTCTATGGGTATTCCAG
CCCACT
>Rosalind_4622
CCATTTGGAGTTTAAGACCTCCTGAGCGTCACGGTAGAAAAGCACTCTCCGCAGTGTACA
TTAGGGAGGCCACAATGGTGTTCTCATCTTTCACTAGCATACGTCGAGAGGCAGAGCTGA
CTAGATCTGGTTATTGCATTAGCGCTAGGCACCCCCAGTCGTCACAACTGAGGCTAAGAT
CTTCTCTATGTGTGCAGGCGCCGCGCTGTTGACTGTCGAGGGTTGGGTCGTTTGGCACAA
TGTTAGGAATTCGAAGCACCCGTAGATGTCGGTCCCCACTCTCCCAGTTTGTAACGCTTA
GTGGGGTTGACGTAAGCCAAGCCCCGGGGATATTGATGTAGGCCGTTCCTGTGTAGTCCC
GTTTCAGATGTGCAAAACGGGCCGGGTGATATTGTCATATAAGATCGTGTGTACAATCTG
TATCTTCACTCCGCTGATTAACCAGGATTAGGGGTATATTGTTCATGTCTTTGGAATCGT
GAGATTTCCTCATGAAGTCCTTGCCGGCCGCGCGTCCCAATAATCATGTTGCGAAGCCCG
GAAGTTAGTAACCTGCGTCCGAAGTCCTTTTCGCGGTCATATAACGGCGTTAGAGCTTCT
CAATCTACATCTCGGGGGGCAAGGACACTTTCCGATGCGTGTTACGTAAGAAACGGCCGG
CACTTCTCCCCACTTTGCGAGATCGTCGGCTTTTTTATGTGAGTCCGCGGGAGTAATTCA
CAACGGTGTTCGATATCCCGGATGTCAGAGGTTGAGGTAAGGATCACGGACGCAATAGCC
ATATCTCCATCTTCGATAAATGTCTTGCCACACCGTCCGCGA
>Rosalind_3646
TTACTTCGGGACTCTAATTCTAAGAACCTCCAACCTAGGAGAGCGGCAGAACTGCCGAAT
TGTGCTCGTCCTGGCGGTCAGCAGTAGATGCCACAATACGAGTCTTTTGGTCCTGCTGTC
CTCGTAACGCGAGCAGTATGACGCTGGAGGTAAGTGGCCCACCCCATAAACGACGCGCCA
AACGTATTTAATAGACATCCCTAATAGCTACAGATGTACTGTATTGACCTCTATGGAACT
CATGTGCGCCCATGACATCCCTGGTTACGGTCATGCCGCCCTCGTCTAGTGGGAGCGCAC
GCCGTGGGAGTCACTGTTCGACAGCTGCGGCCCGGCAAGACCGACCGAAGTTTGGCATAG
CGAACATAAGGGGGCATATCGGTACGCGAAGGAGCTCGGAGCCGGAACACGCCGAACTAC
CCCTTAGGGATTAAGCGGGCTATCTCGATGTCCCCATGGGCCCGGCCCAAGTCACGTGCT
CTTTCCTATTTGCAGATCCACTAAAATAAAATCGGATACTAGCAGATATGACAACCGAGG
TGAAATGTCAGCCGTATTCTATATGTGCGGTGCCATTTGCTAGAAAAGCAATATGATAGC
TTTGGAGCTTAAGGGCCCACAGGAGGCGTGTTGGGCGAACAGGGTAACGAAATTTACTTG
GTTTGCATGTTACTATAACTTTGCTGAGAGAATTCCCGATTCTTTATATGTTATCGGTTG
ACCTTACACAACCACCAGCCCGGGTGGGCTGAGATATCTACTGAGACGCCATGTGCTTAA
GAGTCATTGTGAAGTGACTAGCCGGTAGCTCCAAGTATTCGTCAGCGGAACGGTACACAC
ATGGTTACATTTAGAGGGGAAAGCTGCAAATTTCTTTCTGGTCCCGTTCCCTGGAACTGT
TGGCGTCATCTCGGCAAACCTTAGCCCTTGCACTCGGTATCTAAGGAGTTTTATTGCTAC
AGA
>Rosalind_4240
TGCCACATGCCTTTCAGTGACCGATAAAGAGATAGCCCGCGCTACCTTGTCCTAATATGT
GCACGTTGATCCTAACGGTCCCGGTCGCACTATCGGATCAGATCGTCGCTTATCGATTGT
AGACTCCGATCCTCCGAATCAGCCGTGCCAGCATTAGTCGACTAATGTGAAGTCTTTGAG
GAGGTTCGGGTCTATCTACGACTCACCCGAGGGAACCACAGTGTTTAGGAGATTATAGGC
GTACACTAGTATGCGTAGAGACTTACCGATCGGCTCAGCCCATAGGTCATTCCACGGGCT
AATCGGAACGAATGGTGGTTCCCTGTCTAAATCGTAACAACCACTGTCAAGGCAGGCAGG
CCGACGAACCACTAACAATTCTTAGCCCTTATCTTACTATGGGGACGACCGTCGAAGAAA
GAACCTCGTGAATTAAGCCGTCGTTGGCCGGGAACACCAATTACGGAATACACGCGCCAG
TGGGTTCCGTATGCGACGTATACTCTAAGATTTTGGCCTCCCTGGTTCACCTTTGCCTTT
GTCAACATTCATTATAAGTAGGAATTTTGTAAGTCTTAATTTAATTATTTTGTATGGTAA
TACCGACCTCTTTTTGGTAAACGGACTGGATGGCGCATATCTGGGCAGGCTGCGATAGGG
TATAGTCTCAACAGGGCTCGGCGTGGGATCAATGAACTTATTTTGGCACGTTTCTTGTAC
GTCTAAAGCTTGGCTTGTAGTGAAGGGTGTAGACAATCTAAGCCCAGGGTAAAAGGTTGG
GATCGCACTAATTGCCGGTAACCGGGTTAGCTCA
>Rosalind_0924
AAATGCCATGACCGACCAGAACCCGCTCACCAGCCAGCACACGACGCCAGTAACACAGTG
GTCTGATAAAGCGCCTTCTAAGAAGAATTTGATAAGGTTGAGGCGCGTTTCGACTATCTG
TCTCCCTTCGGTCGACCGTGCACGTACGCCCAAATCGTATACGAAATTTCAGTGATAACG
TGCCGGCAACCTGGCGGATCCACCGATGGGAGTTAGTCGTATGGAAGACGTATTCGCCAT
TTCGAATACGCTTCAAGGTCTCCCTGTCTTTGGGCAATATTCCCCATGTTAAAGTATAGA
GCTACCGGTACCCCGGGCTTATAAGTTTCTGGTTCTACTGGAGGCACCAAATGTCAACAA
GTCGTCGGCGTCACCACTGTCGACGCCGATCCCAGCAGCGGAGACCCTTTCTTGTCTGTG
TCTAGCCCTAGAAGTACCGCTATGGCTCACGGTATTTCCTCACCATATCGGAGCAGGGAT
GAAAACACCCCAGACTGAGTTGAAGTTGTGTTCATAAACACCGGATGCAGGCTCGCAGGA
TGGGGCTCGACCCCTTCTATCCGATATGACCTTTGATTATGATGGAACCGATTTAAGATC
GCTGGATCATACGAAGCGCCTCAATTACCAGCGGCGACTTTCCCGCTTGATGAGCGATGT
TCAGTGAGGGGTTTATGACAGCGATAGTGCTTGCTTTCATCCCGCCGCTACTGCAGAGGA
TAGCGGGAGAAAACATAAGGATGACGCATTGTAGAGCTTGTGGCGTGAAATGGACTACCT
ATCTCGCCGTCTTCGAGTAACATAGCAATTATCACCGATTATGGAGTCCAGGTACTGGTA
TACGCTGCATGGGTTGTCCTTACCTCTCTAACGATAACAAAAGCGCCATGATCGTCCTGT
TTACATGAGAAAAATATAGGGTTGAAAGGGGTAGACTGCCCGGGA
>Rosalind_1266
CGTTCCGTCTCCTACTGCAGATTGTTATAACTCACAAGTTACTGCCACACAACTACCGCT
ACTTATCAGCGAATTGCCTGTTGTTCTGAGAATAGGTAATCACTTCTCTCTCTAAAGGTA
CACCAGCGATTAGACGTCGATGCTATCGGTCACGCGCGTTGGGCTCTGACATACTAGTGC
TCGTTGACCGGACGGATATGACGGGCTCTCTTTACACGATCGGCCTGATGTGTATAGCTC
GGTTGGTCGGACGGTACGCGCGTCATAGGCGTAGGGTTTCGGGGGAATCCACGTTAAAGC
GATCGATAGACCCGGCACGACCTTGCGCCCACTGCGGGGTACCTGCGCGTCTTGTTCTTC
CCACCAGGGCTTAAGTTCAAACGCTTATCGGAACTTCAACTTGTCAAGTGAAGGTATCAG
TCGATAACTTTTTAACGCACACGAGTAGTCACGTCATCGATGCATCTCAAACGGGATATT
TTTCCCCCCCCATCGACTACGTCCCGATTCCAACTGAACTGCAGTGGGGCCTAACGCCAA
AGCGCTAGGTCATGAACCTGTTCTCTGAAACCCCTAACTGCAGGTATCGTGCAACCGCCG
ACGTCCTCTCTTTGTCAGCTCATGCTCACGTAATGCATCCGATTAGTTCTACTATGTGCC
TTTGGCGTACTCAGCCTTTATTCGATATATAAATTAATCTTTATCGGGCCATTGGGGAAG
CATGCGCCTCTTCACGTAAATCCCCAGGCAGAGCACCCCAGGTTCTATGATGGATACTAC
TCCATAACAACCACATATCCCGGTGGACGTATGCTGATAGTCGCGATAAGACCTTGGCAG
GCTAACGTTAACGATCGTTGACAATCTTCTGGCCCCGCCAATCCAAAT
>Rosalind_8973
TGGGACGCCTGTCGTCAACCGTCGGGCTACCACGGCCTTCTAGAATTACTTCACTTATCG
ATGATATGATCGCTACCATACTCTAGACGTGGATACCAATCTTCGTTAATCAAACTAGAC
ATTCCTGTAAGACCTAGTTCCGTAAGTCGTTGCCTTATACGCGAGCGAGGAGCCAAGCAA
ACCCTTTTCAGATTAACGGGGGATTGAATTAGGAATGCGGTATCTTATATAGAAGGAGGA
CGAGGATGTTTTAGAGAGATTGCCTACTGCCTGGCTATGCCGTAGAGTGACCCCTTACGT
AGCACAGCGACGGCCACGAGCCGCTGGCTATCCGAATGGGAGCTCAGTCTTTCACAACTG
TCGGGTTGGCCGTATCTCCAATTCCCATAGCTCGAATGCGCGGTTAGTATTTAGCGTGTA
TGTGATTCTGAAGATTGGGGAATACCGAGGGCACGCACGAGGGCGAGCATCTAATCCAGA
GTCACACCCTCATGTATGTAGTAGTGAGACATGTGTTGTAAGGCTCGTAATAGCGAATGA
GGCTGTAGTCGGCCTAAGTCCACACGCCTCCGAACGCTGTACGCTTAGACACGCCAACGA
TGCAAAATAGTGGCGGAGTAAAAACGAGCAAATTAAACTAAAACGGTACACTAGTGTGCT
AGTATGCAAACGCAATCAACACTTGACTTGCGACATAAATGGATTGCGTTCTCCACTTCT
TTGGGAGCCATTTGGGCGCACGGCACCAAAACTGCGAAGGGTACCTTACTGTCTAGTGAA
TGGAAAATCTAAGTTCCGCGCCATCTGCAAAGCTAAAGCTTACACGCATTCGTTTCCCAG
TGAACATATTCCCGAATCTATGCATCACCGTGTTGCTCAAAGACCCCAAACCCCACACAG
CCTGATCGCTACAGCAGGATGGATCAGAAGGGATTTGCGTC
>Rosalind_6641
TCCACCATAACCTCAGTCCGGAGACGGCACGGCTAAGCATTGGGCAATTATACTTGGAAG
AATACATTTAAACCTTTTTGGGCACAACTCCGTCCGCCTTATGGGACGCATTTAGCTCAT
GCACACAAGTGTCCATGGTGCAAGATTATTTACGAGCGAATAATCTAGCCACGATACTGG
GGGCGCATGTATAGTGGGGTTGGATCCCAGGAATTAATCCGCCTTGTGCGACAAACCTTG
CTTGAGCCGTATGACTCACCTCATGTAGAAAGAAGTGCGAAAAGTCAGTTAGTCGATGTT
ACTTCAATCTTTGGGTTCGGGGCCACATCAGAGTGTGGCACCAGCACGAGGGAGCAGTCT
CAGATACTCGGGACGTAAATAGAATTTGCGGTAAACTTATGGACACTAGCTGACGCCACC
TACGCGCTACGGAACTACACTCGTAGCGAGGAGGATTCGCTCATACTAAATATAGGAAGC
TAATTTTTATTACATGACACGGTAGAAGACAAGCGGACGCGTTACACGGGCCTCACAGGG
GTGGTATAACCAGGGATGTGAACGATACTCATTAAAATAAGATGGCCGGCTACGACGAAC
CACGAATGACGAAACAGACTTAACCAGTACATAACAGAATAGTGGCATTGGCGACGCCAG
TTTTGCAGAAACGGAACTGCACCACCCCAAATATCCAAAAGCATTTTCAACCTCTAACCA
ATGGGGTTGAGGGGATGATTTCCCCGTTTGTGTACAATGAGTGCTTTTGAATGTTTCGGG
CATGCATGTGCGGCTAGTCGGGTCTGAAGGATTATCTTTCACAATGTAAGTCGTGACAGT
GCGGCGTTGTGACTGTAAAACTACATATACAACCGTGGTGCGATTGAACAACTCGCGGCA
GACTTGGAATCTATTTGGCCGATGCCTGGTTACCCATGTGCCGCCACTTCTTTGTGTATT
AAAGCTCTATATTCTTTCGAAATCACGCGCTAC
>Rosalind_4718
CTAAGAAAAGCTTTCCCATGACCAGAAGTGCCACAAGTTGGCACAACCATACTCTGGACG
AAATATGGCATTGTAATTACGGTATGAGGTGTTTAAGATTAACTACATGGGAACAACTCC
GGCGTCTACTTAGCATTTCGGTCGGCCAAGCATCGTTATTGGGATCGGCGGAGCTAGGAG
CGACGTGGGAGTGGGTTCGGATTCTCGTCGACACCATCTACTTCTAACTGCTTATAAGCG
TACGTTACCGTACGGCCCAGAAGGTGCATGGTCATCCAGCCCATTGACGTACCCAGGCTT
GTGGTGTGACATGGAAGTGTGCGTTTAGAGCATCGGAGAGCTCTCGTCACTGTAAACATT
AACTTTCACCAATCTAGTTCGCAGGCCTTTCTGGTCGAAGGAAATGGGAGCGGACCTGAT
GCTATTTTAGGCGCCTGTACAAGAAACAGTAAGTGGTTCTAAAGAACGAGAACTTCTTAA
GGTATTTTGACTTTTCTGTCCGTGGGAGTTGTTTGGGTACCACACTTAGTTCCTCTGTGT
GCTTCGGTGACAATGTATGGTTAGCAACGGTATTGTATGAGGCGAGGCAGCGTAACTCAA
CCTGCACCGTTTGGACATAAGTGGATCCCCATCAAAGAGACTAAACCGTCATAACCTCAG
TTGCGAGAAGCCCTAGCGGCGGAACGCGACGGTTCCTCGCTTGCACATTAGCTACCAAAC
CCCATGTTGTTTAGGCCCCTTATCCATCCACTCCAAGGTCGCACTTCATGCCCGTTACCA
AGTTAATCACGACCGGCTAACCCCTATATAGTAATATGCGATGTTGACGGTTTCACGGTG
GGAGTTCGAATACGTAAAGCTCACCTAGAG
"""
ans1 = 'Rosalind_4622\n50.85158150851582'


class Solution:

    def most_gc_id(self, input):
        seqs = Fasta(input).seqs
        most_gc_id = ''
        max_gc_content = 0
        for seq_id, seq_seq in seqs.items():
            gc = self.gc_content(seq_seq)
            print(gc, seq_id, seq_seq)
            if gc > max_gc_content:
                most_gc_id = seq_id
                max_gc_content = gc
        return "{}\n{}".format(most_gc_id, max_gc_content)

    def gc_content(self, input):
        set1 = set(["G", "C"])
        gc_counter = 0
        total = 0
        for char in input:
            if char in set1:
                gc_counter += 1
            total += 1

        if total == 0:
            return 0

        return gc_counter / total * 100
    

def test_solution():
    input1 = [(
        dict(input=test0), ans0,
    ), 
    (
        dict(input=test1), ans1,
    )
    ]

    for input, expect in input1:
        assert almost_good(Solution().most_gc_id(**input), expect), (input, expect)


def almost_good(ans: str, expect: str):
    ans_l = ans.splitlines()
    expect_l = expect.splitlines()
    assert ans_l[0] == expect_l[0], (ans_l, expect_l)
    v1 = float(ans_l[1]) 
    v2 = float(expect_l[1])
    episilon = abs(v1 - v2)
    return episilon < 0.001
